---
title: "Примери"
author: "Boyko Amarov"
date: "10/17/2021"
output: html_document
---

## Графичен метод

```{r}
library(tidyverse)
```


### Планиране на производство

Бутиково кафене в София предлага два продукта: Супер еспресо и Делукс. За 
приготвянето на един килограм от първия вид кафе са необходими по равни части от 
бразилско и кубинско кафе, а рецептата за Делукс предвижда смес от бразилско и 
кубинско кафе в пропорция 1 към 2. Доставчиците са готови да осигурят 120 кг
бразилско и 160 кг. кубинско кафе. От всеки продаден килограм Супер еспресо 
заведението печели 40 лв., докато за печалбата на килограм Делукс възлиза на 
60 лв. Заведението знае, че няма да може да продаде повече от 
110 кв. Супер еспресо.

Колко от двата типа кафе ще препоръчате на кафенето да приготви?

### Математически модел


### Допустимо множество

```{r}
tribble(
  ~constr, ~x, ~y,
  "1: Бразилско кафе", 120, 0,
  "1: Бразилско кафе", 0, 120,
  "2: Кубинско кафе", 0, 53.33,
  "2: Кубинско кафе", 160, 0,
  "3: Търсене супер еспр.", 110, 0,
  "3: Търсене супер еспр.", 110, 50,
) %>%
  ggplot(aes(x = x, y = y)) +
    geom_point(aes(color = constr)) +
    geom_line(aes(color = constr)) +
    geom_segment(
      data = tibble(x = 0, y = 0, xend = 40, yend = 60),
      aes(x = x, y = y, xend = xend, yend = yend),
      arrow = arrow(
        length=unit(0.30,"cm"),
        ends="last",
        type = "closed")
    ) +
    geom_abline(intercept = c(5160 / 60, 5500 / 60), slope = - 40 / 60, linetype = 2) +
    labs(
      colour = "Ограничение",
      x = expression(paste(x[1], " Супер еспресо, кг.")),
      y = expression(paste(x[2], " Делукс, кг.")),
    )
```
```{r}
A <- matrix(c(
  1, 1,
  1, 2,
  1, 0
  ),
  ncol = 2,
  byrow = TRUE
)
b <- c(40, 60)
r <- c(120, 160, 110)

gMOIP::plotPolytope(
  A = A, 
  b = r, 
  obj = b, 
  crit = "max", 
  plotFeasible = TRUE,
  labels = "coord",
  plotFaces = TRUE,
  # plotOptimum = TRUE
  ) +
  labs(
    x = expression(paste(x[1], " (Супер еспресо кг.)")),
    y = expression(paste(x[2], " (Делукс, кг.)"))
  )
```

### Целева функция, нормален вектор

### Оптимален план

### Реализация в `Excel`

### Реализация в `R`

```{r}
result <- lpSolve::lp(
  direction = "max", ## Вид оптимизация: min/max
  objective.in = b, ## Objective, коефициенти на целевата функция
  const.mat = A, ## Constraints matrix, матрица с коефициенти на ограниченията
  const.dir = "<=", ## Constraints direction, посока на неравенствата
  const.rhs = r, ## Right hand side, дясна страна на ограниченията
  compute.sens=TRUE
)
?lpSolve::lp
```

```{r}
result
```


```{r}
result$solution
```

```{r}
result$duals
```



### Дефицитност на ресурси

### Допустими граници на промяна

### Скрити цени


## Планиране на производство (2)

Фирма, специализирана в производство на зимни палта се опитва да посрещне 
търсенето за нейните стоки с възможно най-малки разходи. Търсенето на палта 
има силни сезонни колебания и фирмата има три опции, за да отговори на сезонните
вариации. В началото на годината фирмата разполага с 30 работника. Всеки от 
работниците може да произведе до 80 палта на сезон (от три месеца). 
Заплатата на всеки работник е 2000 лв. на месец.


- работниците могат да работят и по-продължително, но допълнителният труд се
  заплаща 50% по-скъпо и работниците могат да работят не повече от 20% повече
  от нормалното работно време.
- Произведени в предишния период палта могат да се складират на цена от 12 лв.
  на сезон за всяко палто.
- Фирмата може да назначава и освобождава служители на цени 500 лв. за назначаване 
  и 420 за освобождаване на служите.
- Фирмата няма начални запаси от готови палта

Изгответе математически модел с който да намерите оптималния план 
(в смисъл на най-ниски разходи) за тази фирма.





